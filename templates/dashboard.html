{% extends "base.html" %}

{% block title %}Dashboard - CyberSec Dashboard{% endblock %}

{% block content %}
<div class="container">
    <!-- Welcome Section -->
    <div class="row mt-4 mb-5">
        <div class="col-12">
            <div class="welcome-card">
                <h2>
                    <i class="fas fa-tachometer-alt"></i> 
                    Welcome back, {{ current_user.first_name or 'User' }}!
                </h2>
                <p>Access powerful cybersecurity tools and analyze potential threats.</p>
            </div>
        </div>
    </div>
    
    <!-- Security Modules Grid -->
    <div class="row">
        <!-- Hash Calculator -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-hash"></i>
                        </div>
                        <h5 class="card-title">Hash Calculator</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Generate cryptographic hashes (MD5, SHA-1, SHA-256, SHA-512) for data integrity verification.
                        </small>
                    </div>
                    
                    <form method="POST" action="{{ url_for('hash_calculator') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label">Hash Type</label>
                            <select name="hash_type" class="form-select">
                                <option value="md5">MD5</option>
                                <option value="sha1">SHA-1</option>
                                <option value="sha256" selected>SHA-256</option>
                                <option value="sha512">SHA-512</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Input Text</label>
                            <textarea name="text" class="form-control" rows="2" placeholder="Enter text to hash..."></textarea>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Or Upload File</label>
                            <input type="file" name="file" class="form-control">
                        </div>
                        
                        <button type="submit" class="btn btn-primary btn-glow w-100">
                            <i class="fas fa-calculator"></i> Calculate Hash
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- File Encryption -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <h5 class="card-title">File Encryption</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Secure files using AES encryption with password-based key derivation (PBKDF2).
                        </small>
                    </div>
                    
                    <form method="POST" action="{{ url_for('encrypt') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label">File to Encrypt</label>
                            <input type="file" name="file" class="form-control" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Encryption Password</label>
                            <input type="password" name="password" class="form-control" required>
                        </div>
                        
                        <button type="submit" class="btn btn-success btn-glow w-100">
                            <i class="fas fa-shield-alt"></i> Encrypt File
                        </button>
                    </form>
                    
                    <hr>
                    
                    <form method="POST" action="{{ url_for('decrypt') }}" enctype="multipart/form-data">
                        <h6 class="text-center mb-3">Decrypt File</h6>
                        
                        <div class="mb-3">
                            <label class="form-label">Encrypted File</label>
                            <input type="file" name="file" class="form-control" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Decryption Password</label>
                            <input type="password" name="password" class="form-control" required>
                        </div>
                        
                        <button type="submit" class="btn btn-warning btn-glow w-100">
                            <i class="fas fa-unlock"></i> Decrypt File
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Password Cracker -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-key"></i>
                        </div>
                        <h5 class="card-title">Password Cracker</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Attempt brute force attacks on protected files (PDF, ZIP, Office documents) for password recovery.
                        </small>
                    </div>
                    
                    <div class="alert alert-danger alert-sm">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Legal Notice:</strong> Only use on files you own or have explicit permission to test.
                        Unauthorized access is illegal.
                    </div>
                    
                    <form method="POST" action="{{ url_for('start_brute') }}" enctype="multipart/form-data" onsubmit="return confirmLegality()">
                        <div class="mb-3">
                            <label class="form-label">Protected File</label>
                            <input type="file" name="file" class="form-control" accept=".pdf,.zip,.docx,.pptx,.xlsx" required>
                            <small class="form-text">Supports: PDF, ZIP, DOCX, PPTX, XLSX</small>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Wordlist Type</label>
                            <select name="wordlist" class="form-select">
                                <option value="common">Common Passwords</option>
                                <option value="numbers">Numeric (0000-9999)</option>
                                <option value="years">Years (1900-2029)</option>
                            </select>
                        </div>
                        
                        <button type="submit" class="btn btn-danger btn-glow w-100">
                            <i class="fas fa-hammer"></i> Start Brute Force
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Hash Comparison -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-balance-scale"></i>
                        </div>
                        <h5 class="card-title">Hash Comparison</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Compare cryptographic hashes of two files to verify integrity and detect tampering.
                        </small>
                    </div>
                    
                    <form method="POST" action="{{ url_for('compare') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label">Hash Type</label>
                            <select name="hash_type" class="form-select">
                                <option value="md5">MD5</option>
                                <option value="sha1">SHA-1</option>
                                <option value="sha256" selected>SHA-256</option>
                                <option value="sha512">SHA-512</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">First File</label>
                            <input type="file" name="file1" class="form-control" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Second File</label>
                            <input type="file" name="file2" class="form-control" required>
                        </div>
                        
                        <button type="submit" class="btn btn-info btn-glow w-100">
                            <i class="fas fa-equals"></i> Compare Hashes
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- URL & Malware Scanner -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-shield-virus"></i>
                        </div>
                        <h5 class="card-title">Security Scanner</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Scan URLs for safety and files for malware signatures using basic detection algorithms.
                        </small>
                    </div>
                    
                    <form method="POST" action="{{ url_for('scan_url_route') }}">
                        <div class="mb-3">
                            <label class="form-label">URL to Scan</label>
                            <input type="url" name="url" class="form-control" placeholder="https://example.com" required>
                        </div>
                        
                        <button type="submit" class="btn btn-warning btn-glow w-100 mb-3">
                            <i class="fas fa-search"></i> Scan URL
                        </button>
                    </form>
                    
                    <hr>
                    
                    <form method="POST" action="{{ url_for('scan_file_route') }}" enctype="multipart/form-data">
                        <div class="mb-3">
                            <label class="form-label">File to Scan</label>
                            <input type="file" name="file" class="form-control" required>
                        </div>
                        
                        <button type="submit" class="btn btn-danger btn-glow w-100">
                            <i class="fas fa-virus"></i> Scan for Malware
                        </button>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Vulnerability Scanner -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card module-card">
                <div class="card-body">
                    <div class="module-header">
                        <div class="module-icon">
                            <i class="fas fa-bug"></i>
                        </div>
                        <h5 class="card-title">Vulnerability Scanner</h5>
                    </div>
                    
                    <div class="education-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i>
                            Test websites for common vulnerabilities like SQL injection, XSS, and missing security headers.
                        </small>
                    </div>
                    
                    <div class="alert alert-warning alert-sm">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Ethical Use:</strong> Only scan websites you own or have explicit permission to test.
                    </div>
                    
                    <form method="POST" action="{{ url_for('vulnerability_scan_route') }}" onsubmit="return confirmEthicalUse()">
                        <div class="mb-3">
                            <label class="form-label">Target URL</label>
                            <input type="url" name="url" class="form-control" placeholder="https://target.com" required>
                        </div>
                        
                        <button type="submit" class="btn btn-dark btn-glow w-100">
                            <i class="fas fa-search-plus"></i> Scan Vulnerabilities
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Recent Activity -->
    <div class="row mt-5">
        <div class="col-lg-6 mb-4">
            <div class="card activity-card">
                <div class="card-header">
                    <h6><i class="fas fa-clock"></i> Recent Jobs</h6>
                </div>
                <div class="card-body">
                    {% if recent_jobs %}
                        <div class="activity-list">
                            {% for job in recent_jobs %}
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-{{ 'check' if job.status == 'completed' else 'clock' if job.status == 'running' else 'times' }}"></i>
                                </div>
                                <div class="activity-details">
                                    <strong>{{ job.job_type.replace('_', ' ').title() }}</strong>
                                    <small class="d-block text-muted">{{ job.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
                                    <span class="badge bg-{{ 'success' if job.status == 'completed' else 'warning' if job.status == 'running' else 'danger' }}">
                                        {{ job.status.title() }}
                                    </span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted text-center">No recent jobs</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="col-lg-6 mb-4">
            <div class="card activity-card">
                <div class="card-header">
                    <h6><i class="fas fa-shield-alt"></i> Recent Scans</h6>
                </div>
                <div class="card-body">
                    {% if recent_scans %}
                        <div class="activity-list">
                            {% for scan in recent_scans %}
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-{{ 'shield-alt' if scan.risk_level == 'low' else 'exclamation-triangle' if scan.risk_level == 'medium' else 'skull-crossbones' }}"></i>
                                </div>
                                <div class="activity-details">
                                    <strong>{{ scan.scan_type.title() }} Scan</strong>
                                    <small class="d-block text-muted">{{ scan.target[:50] }}{% if scan.target|length > 50 %}...{% endif %}</small>
                                    <span class="badge bg-{{ 'success' if scan.risk_level == 'low' else 'warning' if scan.risk_level == 'medium' else 'danger' }}">
                                        {{ scan.risk_level.title() }} Risk
                                    </span>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <p class="text-muted text-center">No recent scans</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function confirmLegality() {
    return confirm("I confirm that I own this file or have explicit permission to attempt password recovery. Unauthorized access is illegal and may result in criminal charges.");
}

function confirmEthicalUse() {
    return confirm("I confirm that I own this website or have explicit written permission to perform security testing. Unauthorized scanning may be illegal.");
}
</script>
{% endblock %}
