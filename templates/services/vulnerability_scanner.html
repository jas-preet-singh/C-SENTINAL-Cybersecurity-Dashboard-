{% extends "base.html" %}

{% block title %}Vulnerability Scanner - CyberSec Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
 <div class="row">
 <div class="col-12">
 <div class="d-flex justify-content-between align-items-center mb-3">
 <h2><i class="fas fa-bug"></i> Vulnerability Scanner</h2>
 <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
 <i class="fas fa-home"></i> Back to Home
 </a>
 </div>

 <div class="row">
 <!-- Scanner Form -->
 <div class="col-md-8">
 <div class="card module-card">
 <div class="card-body">
 <form action="{{ url_for('vulnerability_scan_route') }}" method="post" onsubmit="return confirmEthicalUse()">
 <div class="mb-3">
 <label class="form-label">Target URL</label>
 <input type="url" name="url" class="form-control" placeholder="https://example.com" required>
 <small class="form-text text-muted">Enter the website URL to scan for vulnerabilities</small>
 </div>

 <div class="mb-3">
 <div class="form-check">
 <input class="form-check-input" type="checkbox" id="ethicalUse" required>
 <label class="form-check-label" for="ethicalUse">
 I confirm that I have permission to scan this website and will use this tool ethically
 </label>
 </div>
 </div>

 <button type="submit" class="btn btn-danger btn-glow">
 <i class="fas fa-search"></i> Start Vulnerability Scan
 </button>
 </form>
 </div>
 </div>

 <!-- Scan Types -->
 <div class="card module-card mt-3">
 <div class="card-body">
 <h5><i class="fas fa-list-check"></i> Vulnerability Checks Performed</h5>
 <div class="row">
 <div class="col-md-6">
 <ul>
 <li><i class="fas fa-database text-danger"></i> SQL Injection vulnerabilities</li>
 <li><i class="fas fa-code text-warning"></i> Cross-Site Scripting (XSS)</li>
 <li><i class="fas fa-server text-info"></i> Server information disclosure</li>
 <li><i class="fas fa-lock text-success"></i> SSL/TLS configuration</li>
 </ul>
 </div>
 <div class="col-md-6">
 <ul>
 <li><i class="fas fa-header text-primary"></i> Security headers analysis</li>
 <li><i class="fas fa-folder text-warning"></i> Directory traversal</li>
 <li><i class="fas fa-file text-info"></i> Sensitive file exposure</li>
 <li><i class="fas fa-shield-alt text-success"></i> Common misconfigurations</li>
 </ul>
 </div>
 </div>
 </div>
 </div>
 </div>

 <!-- Information Panel -->
 <div class="col-md-4">
 <div class="card module-card">
 <div class="card-body">
 <h5><i class="fas fa-info-circle"></i> About Vulnerability Scanning</h5>
 <p>This scanner performs basic security checks to identify common web vulnerabilities.</p>

 <h6 class="mt-3">Common Vulnerabilities:</h6>
 <ul class="small">
 <li><strong>SQL Injection:</strong> Database manipulation through input fields</li>
 <li><strong>XSS:</strong> Malicious script injection</li>
 <li><strong>CSRF:</strong> Cross-site request forgery</li>
 <li><strong>Security Misconfiguration:</strong> Improper server settings</li>
 </ul>

 <h6 class="mt-3">Scan Limitations:</h6>
 <ul class="small">
 <li>Basic pattern matching</li>
 <li>No deep application logic testing</li>
 <li>Limited to common vulnerabilities</li>
 <li>May produce false positives</li>
 </ul>
 </div>
 </div>

 <!-- Risk Levels -->
 <div class="card module-card mt-3">
 <div class="card-body">
 <h6><i class="fas fa-exclamation-triangle"></i> Risk Levels</h6>
 <div class="mb-2">
 <span class="badge bg-danger me-2">Critical</span>
 <small>Immediate action required</small>
 </div>
 <div class="mb-2">
 <span class="badge bg-warning me-2">High</span>
 <small>Address as soon as possible</small>
 </div>
 <div class="mb-2">
 <span class="badge bg-info me-2">Medium</span>
 <small>Should be addressed</small>
 </div>
 <div class="mb-2">
 <span class="badge bg-success me-2">Low</span>
 <small>Monitor and consider fixing</small>
 </div>
 </div>
 </div>
 </div>
 </div>

 <!-- Legal Notice -->
 <div class="alert alert-danger mt-3">
 <h6><i class="fas fa-gavel"></i> Legal and Ethical Notice</h6>
 <p class="mb-2"><strong>IMPORTANT:</strong> Only scan websites you own or have explicit written permission to test.</p>
 <ul class="mb-0">
 <li>Unauthorized vulnerability scanning may be illegal in your jurisdiction</li>
 <li>Always obtain proper authorization before testing</li>
 <li>Use this tool responsibly and ethically</li>
 <li>Report vulnerabilities through responsible disclosure practices</li>
 </ul>
 </div>
 </div>
 </div>
</div>

<script>
function confirmEthicalUse() {
 return confirm("I confirm that I own this website or have explicit written permission to perform security testing. Unauthorized scanning may be illegal.");
}
</script>
{% endblock %}